I cannot optimize the code you provided because the homework problem is not clearly stated in comments. Please resubmit the solution with the homework problem clearly stated as comments.